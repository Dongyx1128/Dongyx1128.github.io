// .md文章头部数据中加入top值，top值越大越靠前，大于0显示置顶图标。
'use strict';
const pagination = require('hexo-pagination');
module.exports = function(locals){
    var config = this.config;
    var posts = locals.posts;
    posts.data = posts.data.sort(function(a, b) {
        if(a.top == undefined){
            a.top = 0;
        }
        if(b.top == undefined){
            b.top = 0;
        }
        if(a.top == b.top){
            return b.date - a.date;
        }else{
           return b.top - a.top;
        }
    });
    var paginationDir = config.pagination_dir || 'page';
    return pagination('', posts, {
        perPage: config.index_generator.per_page,
        layout: ['index', 'archive'],
        format: paginationDir + '/%d/',
        data: {
            __index: true
        }
    });
};


// 'use strict';

// const pagination = require('hexo-pagination');
// const { sort } = require('timsort');

// module.exports = function(locals) {
//   const config = this.config;
//   const posts = locals.posts.sort(config.index_generator.order_by);

//   sort(posts.data, (a, b) => (b.sticky || 0) - (a.sticky || 0));

//   const paginationDir = config.pagination_dir || 'page';
//   const path = config.index_generator.path || '';

//   return pagination(path, posts, {
//     perPage: config.index_generator.per_page,
//     layout: ['index', 'archive'],
//     format: paginationDir + '/%d/',
//     data: {
//       __index: true
//     }
//   });
// };
